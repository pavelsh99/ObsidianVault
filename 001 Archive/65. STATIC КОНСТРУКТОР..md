---
tags:
  - csharp
  - ООП
date: 2025-11-06
---
[Статический конструктор класса c# | как работает ключевое слово static | C# ООП | # 65](https://www.youtube.com/watch?v=pRc703VTDPY&list=PLQOaTSbfxUtD6kMmAYc8Fooqya3pjLs1N&index=85)

>Статический конструктор создается для `static` элементов класса
# Синтаксис `static` конструктора.

```csharp
    class Myclass
    {
        public Myclass()
        {
            Console.WriteLine("Обычный конструктор");
        }
        static Myclass()
        {
            Console.WriteLine("Static конструктор");
        }
    }
```

> Со `static` конструкторами нельзя использовать модификаторы доступа

> В любом классе может быть только один `static` конструктор. То есть не может быть перегрузок.

> `static` конструктор не может принимать параметров
> ![[Pasted image 20251106190546.png]]

# Как работает `static` конструктор.

> Вызовем в `Main` 4 экземпляра класса чтобы посмотреть как работает `static` конструктор.

```csharp
        static void Main(string[] args)
        {
            Myclass myclass = new Myclass();

            new Myclass();
            new Myclass();
            new Myclass();

        }
```

> Вывод на консоль:
![[Pasted image 20251106191108.png]]

> `static` конструктор выполняется всегда только 1 раз, при взаимодействии с классом


> Добавим `static` метод `Foo` в класс
```csharp
    class Myclass
    {

        static Myclass()
        {
            Console.WriteLine("Static конструктор");
        }

        public static void Foo()
        {
            Console.WriteLine("FOO");
        }
    }
```

```csharp
        static void Main(string[] args)
        {
            Myclass.Foo();

        }
```

> При вызове метода `Main` тоже вызывается статический конструктор перед методом.

![[Pasted image 20251106191542.png]]

# Пример использования `static` конструктора.

>Допустим у нас класс который организует работу с SQL базой данной.

```csharp
    class DbRespository
    {
        private static string conectionStr = "localDb";

        public void GetData()
        {
            Console.Write($"Использую: {conectionStr}");
        }
    }
```

> У каждого объекта будет всегда одна и таже строка подключения `localDb` поэтому нет смысла создавать ее в каждом объекте класса. Достаточно просто создать `static` поле, общее для всех экземпляров.

> Но в этом случае если мы хотим подключиться к новой дб, то нам нужно влезать в исходники программы и менять `conectionStr`

>Нам нужно хранить строку подключения в конфигах, чтобы извлекать ее налету, а не лезть в исходники.


> Мы сделаем заглушку в виде класса `ConfigurationManager` с одним методом `GetConnectionStr`, который возвращает строку подключения `"localDb"`.

```csharp
        class ConfigurationManager
        {
            public string GetConnectionStr()
            {
            return "localDb";
            }
        }
```

> Как мы можем использовать наш метод `ConfigurationManager`?

## 1) Использовать в конструкторе класса:

```csharp

        public DbRespository()
        {
            var configurationManager = new ConfigurationManager();
            configurationManager.GetConnectionStr();
        } 
```

> Но теперь когда мы будем создавать экземпляры класса, то каждый раз будет внутри них создаваться объект класса `configurationManager`, а это занимает память.

```csharp 
DbRespository dbRespository = new DbRespository();
DbRespository dbRespository1 = new DbRespository();
DbRespository dbRespository2= new DbRespository();
```

> Это плохо потому что мы можем создавать много таких объектов, и цель была избежать накладки по памяти.

> Тут нам поможет `static` конструктор, который вызывается лишь раз

## Использовать`static` конструктор


```csharp

		private static string conectionStr;

        public void GetData()
        {
            Console.Write($"Использую: {conectionStr}");
        }
        static DbRespository()
        {
            var configurationManager = new ConfigurationManager();
            conectionStr = configurationManager.GetConnectionStr();
        }
```

> при использовании `static` конструктора мы всего 1 раз выделяем память под `configurationManager` и всего раз присваиваем статической переменной `conectionStr` значение.

> И теперь все объекты класса`dbRespository` теперь будут работать с этой строкой и не терять данные.


# Выводы

> Статический конструктор - это специальный метод, где мы можем инициализировать статические данные класса, если на момент создания класса этих данных нет.

> В сложных проектах используются интерфейсы но об этом в других уроках.